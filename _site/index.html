<!DOCTYPE html>
<html>
   <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>iSEC Research Labs</title>
      <meta name="viewport" content="width=device-width">
      <!-- syntax highlighting CSS -->
      <link rel="stylesheet" href="/css/syntax.css">
      <!-- Custom CSS -->
      <link rel="stylesheet" href="/css/main.css">
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-47756501-1', 'isecpartners.github.io');
        ga('send', 'pageview');

      </script>
   </head>
   <body>
      <div id="container">
         <div class="inner">

               <header>
               <img src="/images/iseclogo.png">
               <h2 class="title">iSEC Research Labs</h2>
               <div id="navbar">
               <a class="extra" href="/">Home</a> |
               <a class="extra" href="/blog">Archives</a> |
               <a class="extra" href="/tools">Tools</a> |
               <a class="extra" href="/research">Research</a>
               </div>
              </header>

            <section id="" class="main_content">
               <!-- This loops through the paginated posts -->

<div>
    <h2 class="posttitle">Cryptopocalypse Reference Paper</h2>
    <h6>20 Mar 2014 - Javed Samuel</h6>
</div>

  <div lang="en" class="postmainpage">

<p>Alex Stamos, Tom Ritter and Javed Samuel presented &quot;Preparing for the
Cryptopocalypse&quot; at Black Hat 2013, looking into the latest breakthroughs in
the academic cryptography community. The original presentation can be
downloaded <a href="https://github.com/iSECPartners/publications/blob/master/presentations/ritter_samuel_stamos_bh_2013_cryptopocalypse.pdf?raw=true">here</a>.</p>

<p>Today we&#39;re releasing a full whitepaper that provides additional detail and
extensive references which will explain the latest breakthroughs in the
academic cryptography community and look ahead at what practical issues could
arise for popular cryptosystems. Specifically, it focuses on the recent major
developments in discrete mathematics and their potential ability to undermine
our trust in the most basic asymmetric primitives, including RSA.</p>

<p>It explain the basic theories behind RSA and the state-of-the-art in large
numbering factoring, and how several recent papers may point the way to
massive improvements in this area. It also describes some of the mathematics
of Elliptic Curve Cryptography (ECC).</p>

<p>The paper then switches to the practical aspects of the doomsday scenario,
and will answer the question &quot;What happens the day after RSA is broken?&quot;
It will point out the many obvious and hidden uses of RSA and related
algorithms and outline how software engineers and security teams can operate
in a post-RSA world. We will also discuss the results of our survey of
popular products and software, and point out the ways in which individuals
can prepare for the &quot;zombie cryptopocalypse&quot;.</p>

<p>The paper provides a detailed list of references to the latest academic papers
related to asymmetric cryptography. In addition, references that discuss the
current level of ECC support in various popular products and software are
included.</p>

<p>The paper can be downloaded <a href="https://github.com/iSECPartners/publications/blob/master/whitepapers/Cryptopocalypse_Reference_Paper.pdf?raw=true">here</a>.</p>

</div>

<div>
    <h2 class="posttitle">AWS environment security assessment with Scout2</h2>
    <h6>19 Feb 2014 - Lo√Øc Simon</h6>
</div>

  <div lang="en" class="postmainpage">

<p>Security engineers at iSEC Partners are regularly involved in projects that
require assessing the security of an Amazon Web Services (AWS) environment.
Thoroughly reviewing AWS configuration requires poring through dozens to
hundreds of pages in the AWS console, depending on the environment&#39;s size. In
2012, iSEC Partners released AWS Scout to help AWS administrators assess their
environment&#39;s security posture. Unfortunately, APIs have changed since then,
and the tool wasn&#39;t written in a particularly maintainable fashion.</p>

<h3>AWS Scout2</h3>

<p>iSEC Partners developed a new, more comprehensive, version of AWS Scout in order
to address its need for an AWS configuration review tool. AWS Scout2 is an
open-source application written in Python that connects to the AWS API and
downloads configuration data for the following AWS services:</p>

<ul>
<li>Identity and Access Management (IAM)</li>
<li>Elastic Compute Cloud (EC2)</li>
<li>Simple Storage Service (S3)</li>
</ul>

<p>The information gathered is then rendered in an offline HTML report. In
addition to AWS configuration, this HTML report displays a number of security
risks.</p>

<h3>Project page</h3>

<p>iSEC Partners is pleased to release AWS Scout2 to the security community. See
the Github repository page for full details on how to download and use the tool:</p>

<p><a href="http://isecpartners.github.io/Scout2/">https://github.com/iSECPartners/Scout2</a></p>

</div>

<div>
    <h2 class="posttitle">iOS certificate pinning code updated for iOS 7</h2>
    <h6>01 Feb 2014 - Alban Diquet</h6>
</div>

  <div lang="en" class="postmainpage">

<p>We&#39;ve updated the iOS certificate pinning code which is part of iSEC&#39;s
<a href="https://github.com/iSECPartners/ssl-conservatory/tree/master/ios">SSL Conservatory</a> project on Github. This new version brings the
following changes:</p>

<ul>
<li>The Xcode project was re-created as a static library (instead of an iOS App)
to facilitate integration. Sample code demonstrating how to use the library has
been moved the project&#39;s unit tests.</li>
<li>A new convenience delegate class for <em>NSURLSession</em>, the HTTP connection
framework introduced in iOS 7, was added to the project. Similarly to the
existing convenience class for <em>NSURLConnection</em> this class makes it easy to add
certificate pinning to connections relying on <em>NSURLSession</em>.</li>
</ul>

<h3>Project page</h3>

<p>Code and instructions are available on the project&#39;s <a href="https://github.com/iSECPartners/ssl-conservatory/tree/master/ios">Github page</a>.</p>

</div>

<div>
    <h2 class="posttitle">Announcing the Release of RtspFuzzer</h2>
    <h6>07 Jan 2014 - Michael Lynch</h6>
</div>

  <div lang="en" class="postmainpage">

<p>iSEC Partners is pleased to announce the release of RtspFuzzer, an open-source fuzzer for the real-time streaming protocol (RTSP). RTSP is a text-based protocol that facilitates media streaming. We have been developing this fuzzer over the past several months as we fuzz different media players. Though this protocol doesn&#39;t receive much attention, most popular media players implement it and these implementations have previously been a source of critical security vulnerabilities (including <a href="http://cvedetails.com/cve/2007-6166">QuickTime</a> and <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3225">Windows Media Player</a>).</p>

<p>Using RtspFuzzer, we <a href="http://isecpartners.github.io/fuzzing/vulnerabilities/2013/12/30/vlc-vulnerability.html">uncovered a new, critical vulnerability</a> in the Live555 library, an open-source implementation of the RTSP protocol that several media players and servers use, including VLC. The vulnerability allowed an attacker to gain remote code execution on a victim&#39;s system if they could induce a VLC user to visit a malicious web page or open a malicious playlist file.</p>

<h3>Using RtspFuzzer</h3>

<p>See the Github repository page to download the tool and for quick start instructions:</p>

<p><a href="https://github.com/iSECPartners/RtspFuzzer">https://github.com/iSECPartners/RtspFuzzer</a></p>

<p>We created the fuzzer using the <a href="http://www.peachfuzzer.com">Peach fuzzing framework</a>. RtspFuzzer has built-in configurations for Windows binaries of QuickTime, VLC, and openRTSP, but users can easily adjust the configuration and use this fuzzer to test any RTSP client on any Peach-compatible platform.</p>

<h3>Advice for developing fuzzers with Peach</h3>

<p>Creating RtspFuzzer was a great way to learn to use Peach. Peach is a very powerful framework for fuzzing, but many people shy away from it and instead create one-off fuzzers because they perceive Peach&#39;s learning curve as too steep. Peach does indeed take some time to learn, but it does also save you from rolling your own implementation of a lot of things that Peach does for you, such as integrating with debuggers, mutating your data to match common attack patterns, or logging results in an organized way.</p>

<p>I would like to see Peach succeed because, despite its current problems, Peach makes it easy to write fuzzers that others can reuse and adapt. As more people use Peach, more information about its use will be available and this will reduce the learning curve. The Peach development team is <a href="http://forums.peachfuzzer.com/forumdisplay.php?2-Peach-3-Beta">very responsive</a>, and as the user base increases, more people will be able to report bugs and feature suggestions. If you&#39;re thinking of writing a fuzzer with Peach, keep the following tips in mind:</p>

<ul>
<li><strong>Treat your Peach pit like a regular program.</strong> Keep it under source control and use bug tracking to maintain a list of issues in your fuzzer. Debugging your fuzzer will be a <em>lot</em> easier if you can revert to a known good state.</li>
<li><strong>Expect bugs in Peach.</strong> While Peach has existed since 2004, the latest 3.x version is a complete rewrite of the product in .NET and was first released in May, 2013. Peach works well for the most part, but there are definitely some rough edges, especially as your pits get more complex. You need to account for this in planning if you&#39;re building your fuzzer on a schedule. I recommend building Peach from source so that if you suspect you&#39;ve run into a bug in the framework itself, you can debug it more easily.</li>
<li><strong>Fuzz early and fuzz often.</strong> When I started working on the RTSP fuzzer, my first task was to define the RTSP protocol as precisely as I could in Peach. What I <em>wish</em> I had done first was build a mostly dumb fuzzer that spoke just enough RTSP to do basic fuzzing of a test application such as VLC, then build up from there. Seeing how Peach works and how it interprets the data in pit files is immensely helpful in designing your fuzzer. Look at the kind of data that Peach generates and see if anything is causing iterations to run slowly or to stop.</li>
</ul>

</div>

<div>
    <h2 class="posttitle">iOS 7 tool updates</h2>
    <h6>02 Jan 2014 - Alban Diquet</h6>
</div>

  
  <div lang="en" class="post">

<p>With the availability of the evasi0n7 jailbreak and the subsequent release two
days ago of <a href="http://www.cydiasubstrate.com/">Cydia Substrate</a> with support for iOS 7 and ARM64, a
full-blown iOS 7 penetration testing environment can now be setup. To this
extent, we&#39;ve updated our <a href="https://github.com/iSECPartners/">publicly available</a> iOS tools for blackbox
testing in order to add support for iOS 7 and ARM64. We just released the two
following updates:</p>

<ul>
<li><a href="https://github.com/iSECPartners/ios-ssl-kill-switch/releases">iOS SSL Kill Switch v0.5</a>, our tool to disable SSL certificate
verification/pinning.</li>
<li><a href="https://github.com/iSECPartners/Introspy-iOS/releases">Introspy-iOS v0.4</a>, our iOS Apps security profiler.</li>
</ul>

<p>The pre-compiled packages for these tools now contain both an armv7 and an
arm64 slice, which means that they will work on 64 bits iOS Apps for devices
with an A7 chip (such as the iPhone 5s and the iPad Air).</p>

<p>Both tools were successfully tested on an iPhone 5s running iOS 7.0.4:</p>

<p><center> <img src="/images/introspy-ios7.png" alt="screenshot"> </center></p>

<h3>Sandbox changes in iOS 7</h3>

<p>While testing Introspy-iOS on iOS 7, I ran into issues with the <em>sandboxd</em>
daemon denying write access to specific files the tool was trying to create.
Interestingly enough, it seems like the Seatbelt profiles deployed on iOS 7
have been updated, compared to iOS 6. Specifically:</p>

<ul>
<li>AppStore Apps can no longer write to the root folder of their container
directory, for example
<em>/var/mobile/Applications/3152B928-D771-424C-AE39-F79EC4A79EC5/</em></li>
<li>System Apps can no longer write to <em>/var/mobile/</em></li>
</ul>

<p>Because of these changes, I had to modify the locations where Introspy-iOS
stores its files, to the following paths:</p>

<ul>
<li><em>[App Container]/Library/</em> for AppStore Apps.</li>
<li><em>/var/mobile/Library/Preferences/</em> for System Apps.</li>
</ul>

<p>It is unclear why the Seatbelt profiles were changed, although the ability to
write to these locations was not actually needed by Apps. More information
regarding the Seatbelt profiles used for various iOS Apps is available on the
<a href="http://iphonedevwiki.net/index.php/Seatbelt">iphonedev wiki</a>.</p>

</div>


<!-- Pagination links - http://jekyllrb.com/docs/pagination/ -->

<div class="pagination">
  
    <span>&laquo; Prev</span>
  

  
    
      <em>1</em>
    
  
    
      <a href="/page2">2</a>
    
  
    
      <a href="/page3">3</a>
    
  
    
      <a href="/page4">4</a>
    
  
    
      <a href="/page5">5</a>
    
  
    
      <a href="/page6">6</a>
    
  

  
    <a href="/page2">Next &raquo;</a>
  
</div>


            </section>


            <footer style="clear: both;">
               <div> iSEC Partners 2014 -
                     <a href="https://github.com/isecpartners/">iSEC on GitHub</a> -
                     <a href="https://www.isecpartners.com/about/careers.aspx">Join us!</a>
               </div>
            </footer>
         </div>
      </div>
      <!-- /container -->
   </body>
</html>
