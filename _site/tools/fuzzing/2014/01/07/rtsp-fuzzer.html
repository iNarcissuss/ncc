<!DOCTYPE html>
<html>
   <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Announcing the Release of RtspFuzzer</title>
      <meta name="viewport" content="width=device-width">
      <!-- syntax highlighting CSS -->
      <link rel="stylesheet" href="/css/syntax.css">
      <!-- Custom CSS -->
      <link rel="stylesheet" href="/css/main.css">
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-47756501-1', 'isecpartners.github.io');
        ga('send', 'pageview');

      </script>
   </head>
   <body>
      <div id="container">
         <div class="inner">

               <header>
               <img src="/images/iseclogo.png">
               <h2 class="title">iSEC Research Labs</h2>
               <div id="navbar">
               <a class="extra" href="/">Home</a> |
               <a class="extra" href="/blog">Archives</a> |
               <a class="extra" href="/tools">Tools</a> |
               <a class="extra" href="/research">Research</a>
               </div>
              </header>

            <section id="/tools/fuzzing/2014/01/07/rtsp-fuzzer" class="main_content">
               <!-- Blog post-->
<div>
	<h2>Announcing the Release of RtspFuzzer</h2>
    <h6>07 Jan 2014 - Michael Lynch</h6>
</div>

<div lang="en" class="post">
<p>iSEC Partners is pleased to announce the release of RtspFuzzer, an open-source fuzzer for the real-time streaming protocol (RTSP). RTSP is a text-based protocol that facilitates media streaming. We have been developing this fuzzer over the past several months as we fuzz different media players. Though this protocol doesn&#39;t receive much attention, most popular media players implement it and these implementations have previously been a source of critical security vulnerabilities (including <a href="http://cvedetails.com/cve/2007-6166">QuickTime</a> and <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3225">Windows Media Player</a>).</p>

<p>Using RtspFuzzer, we <a href="http://isecpartners.github.io/fuzzing/vulnerabilities/2013/12/30/vlc-vulnerability.html">uncovered a new, critical vulnerability</a> in the Live555 library, an open-source implementation of the RTSP protocol that several media players and servers use, including VLC. The vulnerability allowed an attacker to gain remote code execution on a victim&#39;s system if they could induce a VLC user to visit a malicious web page or open a malicious playlist file.</p>

<h3>Using RtspFuzzer</h3>

<p>See the Github repository page to download the tool and for quick start instructions:</p>

<p><a href="https://github.com/iSECPartners/RtspFuzzer">https://github.com/iSECPartners/RtspFuzzer</a></p>

<p>We created the fuzzer using the <a href="http://www.peachfuzzer.com">Peach fuzzing framework</a>. RtspFuzzer has built-in configurations for Windows binaries of QuickTime, VLC, and openRTSP, but users can easily adjust the configuration and use this fuzzer to test any RTSP client on any Peach-compatible platform.</p>

<h3>Advice for developing fuzzers with Peach</h3>

<p>Creating RtspFuzzer was a great way to learn to use Peach. Peach is a very powerful framework for fuzzing, but many people shy away from it and instead create one-off fuzzers because they perceive Peach&#39;s learning curve as too steep. Peach does indeed take some time to learn, but it does also save you from rolling your own implementation of a lot of things that Peach does for you, such as integrating with debuggers, mutating your data to match common attack patterns, or logging results in an organized way.</p>

<p>I would like to see Peach succeed because, despite its current problems, Peach makes it easy to write fuzzers that others can reuse and adapt. As more people use Peach, more information about its use will be available and this will reduce the learning curve. The Peach development team is <a href="http://forums.peachfuzzer.com/forumdisplay.php?2-Peach-3-Beta">very responsive</a>, and as the user base increases, more people will be able to report bugs and feature suggestions. If you&#39;re thinking of writing a fuzzer with Peach, keep the following tips in mind:</p>

<ul>
<li><strong>Treat your Peach pit like a regular program.</strong> Keep it under source control and use bug tracking to maintain a list of issues in your fuzzer. Debugging your fuzzer will be a <em>lot</em> easier if you can revert to a known good state.</li>
<li><strong>Expect bugs in Peach.</strong> While Peach has existed since 2004, the latest 3.x version is a complete rewrite of the product in .NET and was first released in May, 2013. Peach works well for the most part, but there are definitely some rough edges, especially as your pits get more complex. You need to account for this in planning if you&#39;re building your fuzzer on a schedule. I recommend building Peach from source so that if you suspect you&#39;ve run into a bug in the framework itself, you can debug it more easily.</li>
<li><strong>Fuzz early and fuzz often.</strong> When I started working on the RTSP fuzzer, my first task was to define the RTSP protocol as precisely as I could in Peach. What I <em>wish</em> I had done first was build a mostly dumb fuzzer that spoke just enough RTSP to do basic fuzzing of a test application such as VLC, then build up from there. Seeing how Peach works and how it interprets the data in pit files is immensely helpful in designing your fuzzer. Look at the kind of data that Peach generates and see if anything is causing iterations to run slowly or to stop.</li>
</ul>

</div>


<!-- Links to previous/next posts -->
<div class="postswitch">


  <h6 class="navpost "><span class="right"> &raquo; </span> <a class="navright" href="/ios/introspy/tools/2014/01/02/ios7-tool-update.html" title="Previous Post: iOS 7 tool updates">iOS 7 tool updates</a></h6>




  <h6 class="navpost"> <span>&laquo;</span> <a class="navleft"  href="/tools/ios/ssl/2014/02/01/ios-pinning-updated.html" title="Next Post: iOS certificate pinning code updated for iOS 7">iOS certificate pinning code updated for iOS 7</a></h6>


</div>


            </section>


            <footer style="clear: both;">
               <div> iSEC Partners 2014 -
                     <a href="https://github.com/isecpartners/">iSEC on GitHub</a> -
                     <a href="https://www.isecpartners.com/about/careers.aspx">Join us!</a>
               </div>
            </footer>
         </div>
      </div>
      <!-- /container -->
   </body>
</html>
